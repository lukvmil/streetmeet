(function(){"use strict";var e={3205:function(e,n,t){var o=t(9242),i=t(3396);const r={key:0},a={key:1};function l(e,n,t,o,l,u){const c=(0,i.up)("router-link"),s=(0,i.up)("router-view");return e.peerInitialized?((0,i.wg)(),(0,i.iD)("div",a,[(0,i._)("nav",null,[(0,i.Wm)(c,{to:"/"},{default:(0,i.w5)((()=>[(0,i.Uk)("Home")])),_:1}),(0,i.Uk)(" | "),(0,i.Wm)(c,{to:"/about"},{default:(0,i.w5)((()=>[(0,i.Uk)("About")])),_:1})]),(0,i.Wm)(s)])):((0,i.wg)(),(0,i.iD)("div",r,"Loading..."))}var u=t(4870);const c=(0,u.qj)({peerInitialized:!1,users:[],profile:{},chats:{}});var s=t(6265),d=t.n(s);const p=d().create({baseURL:"/api"});var v=p;const f=()=>{c.profile._id&&v.post("/user/"+c.profile._id)},m=()=>{setInterval(f,5e3)};var g=(0,i.aZ)({name:"App",setup(){const e=(0,i.Fl)((()=>c.peerInitialized));return window.addEventListener("beforeunload",(()=>{})),m(),{peerInitialized:e}}}),w=t(89);const h=(0,w.Z)(g,[["render",l]]);var b=h,y=t(2483);const _={class:"home"},k=(0,i._)("h1",null,"StreetMeet",-1);function I(e,n,t,o,r,a){const l=(0,i.up)("Info"),u=(0,i.up)("PeopleList");return(0,i.wg)(),(0,i.iD)("div",_,[k,e.profile._id?((0,i.wg)(),(0,i.j4)(u,{key:1})):((0,i.wg)(),(0,i.j4)(l,{key:0}))])}const D=(0,i._)("h1",null,"Hello!",-1);function H(e,n,t,r,a,l){return(0,i.wg)(),(0,i.iD)(i.HY,null,[D,(0,i._)("div",null,[(0,i.wy)((0,i._)("input",{type:"text",placeholder:"Enter a username!","onUpdate:modelValue":n[0]||(n[0]=n=>e.username=n)},null,512),[[o.nr,e.username]])]),(0,i._)("div",null,[(0,i.wy)((0,i._)("input",{type:"text",placeholder:"What's on your mind today?","onUpdate:modelValue":n[1]||(n[1]=n=>e.topic=n)},null,512),[[o.nr,e.topic]])]),(0,i._)("div",null,[(0,i._)("button",{onClick:n[2]||(n[2]=(...n)=>e.submit&&e.submit(...n))},"Submit")])],64)}t(1703),t(7658);var O=t(1113);const z=new O._z;z.on("open",(()=>{c.peerInitialized=!0}));z.on("connection",(e=>{const n=e;j(n)}));const j=e=>{e&&(e.on("data",(n=>{c.chats[e.peer].messages.push({text:n})})),e.on("open",(()=>{c.chats[e.peer]={messages:[],disconnected:!1,conn:e}})),e.on("close",(()=>{c.chats[e.peer].disconnected=!0})))};window.peer=z;var Z=(0,i.aZ)({name:"InfoVue",setup(){const e=(0,u.iH)(""),n=(0,u.iH)(""),t=(0,u.iH)(),o=e=>{if(!("geolocation"in navigator))throw new Error("Location not available");navigator.geolocation.getCurrentPosition((n=>{t.value={lat:n.coords.latitude,lon:n.coords.longitude},e()}))},i=()=>{o((async()=>{const o=await v.post("/user",{username:e.value,topic:n.value,peerId:z.id,location:[t.value?.lon,t.value?.lat]});console.log(o.data),c.profile=o.data}))};return{username:e,topic:n,submit:i}}});const L=(0,w.Z)(Z,[["render",H]]);var P=L,x=t(7139);const C={key:0},M=(0,i._)("h1",null,"People",-1),U={key:1};function S(e,n,t,o,r,a){return e.people?((0,i.wg)(),(0,i.iD)("div",C,[M,((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.people,(e=>((0,i.wg)(),(0,i.iD)("div",{key:e._id},[(0,i._)("h3",null,(0,x.zw)(e.username),1),(0,i._)("div",null,"Topic: "+(0,x.zw)(e.topic),1)])))),128))])):((0,i.wg)(),(0,i.iD)("div",U,"Loading..."))}var V=(0,i.aZ)({name:"PeopleList",setup(){const e=(0,u.iH)(),n=(0,i.Fl)((()=>c.profile)),t=async()=>{const n=await v.get("/match/"+c.profile._id);e.value=n.data};return t(),{people:e,profile:n}}});const T=(0,w.Z)(V,[["render",S]]);var F=T,E=(0,i.aZ)({name:"HomeView",components:{Info:P,PeopleList:F},setup(){const e=(0,i.Fl)((()=>c.profile));return{profile:e}}});const W=(0,w.Z)(E,[["render",I]]);var Y=W;const q={class:"about"},A=(0,i._)("h1",null,"This is an about page",-1),K=[A];function R(e,n){return(0,i.wg)(),(0,i.iD)("div",q,K)}const B={},G=(0,w.Z)(B,[["render",R]]);var J=G;const N=["disabled"],Q={key:0},X=(0,i._)("div",null,"Connected!",-1),$=(0,i._)("h2",null,"Messages",-1),ee=(0,i._)("br",null,null,-1);function ne(e,n,t,r,a,l){return(0,i.wg)(),(0,i.iD)("div",null,[(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":n[0]||(n[0]=n=>e.remoteId=n),type:"text",placeholder:"Remote ID"},null,512),[[o.nr,e.remoteId]]),(0,i._)("button",{onClick:n[1]||(n[1]=(...n)=>e.connect&&e.connect(...n)),disabled:e.connected},"Connect",8,N),(0,i._)("div",null,"Local ID: "+(0,x.zw)(e.peerInitialized?e.localId:"Loading..."),1),e.connected?((0,i.wg)(),(0,i.iD)("div",Q,[X,$,((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.messages,(e=>((0,i.wg)(),(0,i.iD)("div",{key:e},[(0,i._)("div",null,(0,x.zw)(e),1)])))),128)),(0,i.wy)((0,i._)("input",{type:"text","onUpdate:modelValue":n[2]||(n[2]=n=>e.messageInput=n)},null,512),[[o.nr,e.messageInput]]),(0,i._)("button",{onClick:n[3]||(n[3]=(...n)=>e.sendMessage&&e.sendMessage(...n))},"Send"),(0,i.Uk)(),ee,(0,i._)("button",{onClick:n[4]||(n[4]=(...n)=>e.disconnect&&e.disconnect(...n))},"Disconnect")])):(0,i.kq)("",!0)])}var te=(0,i.aZ)({name:"MessageVue",setup(){const e=(0,u.iH)(""),n=(0,u.iH)(z.id),t=(0,u.iH)(""),o=(0,u.iH)(!1),r=(0,i.Fl)((()=>c.peerInitialized));let a=null;z.on("open",(()=>{n.value=z.id}));const l=(0,u.iH)([]),s=()=>{a=z.connect(e.value),d()};z.on("connection",(e=>{a=e,d()}));const d=()=>{a&&(a.on("data",(e=>{l.value.push(e)})),a.on("open",(()=>{o.value=!0})),a.on("close",(()=>{o.value=!1})))},p=()=>{a&&(a.send(t.value),l.value.push(t.value))},v=()=>{a&&a.close()};return{remoteId:e,localId:n,connect:s,messages:l,connected:o,messageInput:t,sendMessage:p,disconnect:v,peerInitialized:r}}});const oe=(0,w.Z)(te,[["render",ne]]);var ie=oe;const re=[{path:"/",name:"home",component:Y},{path:"/about",name:"about",component:J},{path:"/message",name:"message",component:ie}],ae=(0,y.p7)({history:(0,y.PO)("/"),routes:re});var le=ae;const ue=(0,o.ri)(b);ue.use(le),ue.mount("#app")}},n={};function t(o){var i=n[o];if(void 0!==i)return i.exports;var r=n[o]={exports:{}};return e[o](r,r.exports,t),r.exports}t.m=e,function(){var e=[];t.O=function(n,o,i,r){if(!o){var a=1/0;for(s=0;s<e.length;s++){o=e[s][0],i=e[s][1],r=e[s][2];for(var l=!0,u=0;u<o.length;u++)(!1&r||a>=r)&&Object.keys(t.O).every((function(e){return t.O[e](o[u])}))?o.splice(u--,1):(l=!1,r<a&&(a=r));if(l){e.splice(s--,1);var c=i();void 0!==c&&(n=c)}}return n}r=r||0;for(var s=e.length;s>0&&e[s-1][2]>r;s--)e[s]=e[s-1];e[s]=[o,i,r]}}(),function(){t.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(n,{a:n}),n}}(),function(){t.d=function(e,n){for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)}}(),function(){t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};t.O.j=function(n){return 0===e[n]};var n=function(n,o){var i,r,a=o[0],l=o[1],u=o[2],c=0;if(a.some((function(n){return 0!==e[n]}))){for(i in l)t.o(l,i)&&(t.m[i]=l[i]);if(u)var s=u(t)}for(n&&n(o);c<a.length;c++)r=a[c],t.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return t.O(s)},o=self["webpackChunkclient1"]=self["webpackChunkclient1"]||[];o.forEach(n.bind(null,0)),o.push=n.bind(null,o.push.bind(o))}();var o=t.O(void 0,[998],(function(){return t(3205)}));o=t.O(o)})();
//# sourceMappingURL=app.0d722407.js.map